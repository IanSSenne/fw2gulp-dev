if(Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(void 0!==n&&null!==n){n=Object(n);for(var s=Object.keys(Object(n)),i=0,o=s.length;i<o;i++){var l=s[i],h=Object.getOwnPropertyDescriptor(n,l);void 0!==h&&h.enumerable&&(t[l]=n[l])}}}return t}}),String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{enumerable:!1,value:function(e,t=-1){return this.filter(function(r,n){return r==e&&n>t}).length>0}}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(e){let t=[];for(let r=0;r<this.value;r++)t.push(e);return t}}),!t)var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0987654321!@#$%^&*()",t=function(t){let r=[];for(let t=0;t<128;t++)r.push(e[Math.floor(Math.random()*e.length)]);return"IESymbol("+r.join("")+(t||"")+")"};function r(e){return t(e)}r.$Symbol=function(){return t}.bind(window)();const n=r();class s{constructor(e){this._relientObjects=[],this.relatedNodes=[],this._value=e}hasRelatedNodes(){return this.relatedNodes.length>0}addRelient(e){this._relientObjects.push(e)}get value(){return this._value}set value(e){this._value=e,e&&e.constructor===Array?(this.relatedNodes=[],e.forEach(e=>{e.isVElement&&this.relatedNodes.push(e)})):e&&e.isVElement&&(this.relatedNodes=[e]);for(let e=0;e<this._relientObjects.length;e++)this._relientObjects[e].setRelientStateDirty(this)}get[n](){return!0}[r.$Symbol.iterator](){return function*(e){yield e}(this._value)}}function i(e){return new s(e)}function o(...e){let t=[],r={get value(){let t="";for(let r=0;r<e.length;r++)e[r]&&e[r][n]?t+=e[r].value:e[r]&&(t+=e[r]);return t},addRelient(e){t.push(e)},setRelientStateDirty(){t.forEach(function(e){e.setRelientStateDirty&&e.setRelientStateDirty(r)})},[n]:!0};for(let t=0;t<e.length;t++)e[t]&&e[t][n]&&e[t].addRelient(r);return r}var l;l||(l=requestAnimationFrame);const h=[],c={timeout:500},a=l||requestAnimationFrame;function d(){let e=h.shift();if(e)for(e.rerender();h[0];)(e=h.shift()).rerender()}const p=r();class u{constructor(e){if(this.WARNIFINRENDER=0,this._initialized=!1,this._relient=[],this.isSvg=!1,this.props=e,!this.renderFunctionExists())throw new Error("Components must define a render function")}renderFunctionExists(){return this.render instanceof Function}renderInternal(){if(!this._initialized){let e=Object.keys(this);for(let t=0;t<e.length;t++)this[e[t]]&&this[e[t]][n]&&this[e[t]].addRelient(this);this._initialized=!0}this.WARNIFINRENDER++;let e=this.render();return this.WARNIFINRENDER--,this._element?this._element.diff(e,!0):this._element=e,this._element.element(this.isSvg)}element(){return this._element?this._element.element(this.isSvg):this.renderInternal()}render(){}rerender(){return this.WARNIFINRENDER&&console.warn("rerender initiated from within the render call, this should be avoided if posible"),this.WARNIFINRENDER>10?(console.error("rerender error: rerender is being called within render several times in a row, this most likeally means that there is an issue."),null):this.renderInternal()}addRelient(e){this._relient.includes(e)||this._relient.push(e)}setRelientStateDirty(e){h.includes(this)||h.push(this),a(d,c)}get[n](){return!0}setIsSvg(e){this.isSvg=e}}u.prototype[p]=!0;const f=[];class g{constructor(){this.funcs={log:console.log.bind(console,"%c ians-fw %c log %c ","background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background: gray; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),error:console.log.bind(console,"%c ians-fw %c error %c ","background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background: rgb(190, 0, 0); padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),warn:console.log.bind(console,"%c ians-fw %c warn %c ","background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background: rgb(207, 162, 0); padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent")},this._enabled=!1,f.push(this)}get enabled(){return this._enabled}set enabled(e){this._enabled=e,f.forEach(t=>t._enabled=e)}log(...e){this._enabled&&this.funcs.log(...e)}error(...e){this._enabled&&this.funcs.error(...e)}warn(...e){this._enabled&&this.funcs.warn(...e)}createInternalInstance(){return this.createInstance("fw2gulp INTERNAL ")}createInstance(e){let t=new g;return t.funcs={log:console.log.bind(console,`%c ${e} %c log %c `,"background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background: gray; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),error:console.log.bind(console,`%c ${e} %c error %c `,"background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background: rgb(190, 0, 0); padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),warn:console.log.bind(console,`%c ${e} %c warn %c `,"background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background: rgb(207, 162, 0); padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent")},t}}let m;var b=m=new g;Object.defineProperty(window||globalThis||new Function("this")(),"FW2VERBOSE",{value:m});const v=!1,y=r("is-ref");class _{constructor(){this._onupdatecbs=[]}get dom(){return this._element._element}get virtual(){return this._element}setRef(e){this._element=e,this._element._element&&this._onupdatecbs.forEach(e=>e(this))}watch(e){return this._onupdatecbs.push(e),()=>{this._onupdatecbs.splice(this._onupdatecbs.indexOf(e),1)}}get[y](){return!0}}function w(e){let t=[];const r=Object.keys(e);for(let s=0;s<r.length;s++){const i=r[s];e[i]&&e[i][y]||(e[i]&&e[i][n]?t.push(e[i]):"object"==typeof e[i]&&t.push(...w(e[i])))}return t}const x=new Map;function O(e){return x.get(e).hooks}function E(e,t){x.set(e,{hooks:[]})}function j(e,t){x.get(e).hooks.forEach(e=>{e(t)})}function R(e,t){const r=x.get(e);if(!r)throw new Error("unable to subscribe to hook, hook '"+e+"' does not exist");r.hooks.push(t)}E("domrenderstart",!1),E("domrenderend",!1),E("vdomcreate",!1);const S=b.createInternalInstance();function k(e,t){const r=Object.keys(t);for(let s=0;s<r.length;s++){const i=r[s],o=t[i];o&&o[n]?e[i]=o.value:(Object.isSealed(e)||Object.isFrozen(e))&&(e[i]=o)}}S.enabled=!0;class N{constructor(e){this.references=new Map,this.initializer=e,this._elements=[],this._elements instanceof Array||(this._elements=[this._elements]),this.render()}render(){for(let e=0;e<this._elements.length;e++){const t=this._elements[e]._element;t.parentElement.removeChild(t)}this._elements=this.initializer();for(let e=0;e<this._elements.length;e++){const t=[...this._elements[e].references.keys()];for(let r=0;r<t.length;r++)this.references.has(t[r])||this.references.set(t[r],[]),this.references.get(t[r]).push(this._elements[e]),t[r].addRelient(this)}}setRelientStateDirty(e){return null}}function I(e,t=[]){for(let r=0;r<e.length;r++)e[r]instanceof Array?I(e[r],t):t.push(e[r]);return t}class A{constructor(e,t,r){this.childrefs=[],this.references=new Map;const n=I(r);this.type=e,this.props=t||{},this.children=n,this.states=[],this.isSvg="svg"===this.type}element(e){return this._element||this.render(e||this.isSvg),this._element}setIsSvg(e=!0){return this.isSvg||e?(this.isSvg=e,this.children.forEach(t=>{t.setIsSvg&&t.isSvg===!e?t.setIsSvg(this.isSvg):"object"==typeof t&&Object.getPrototypeOf(t)===u&&t.setIsSvg(this.isSvg)}),this.isSvg):e}render(e){j("domrenderstart",this),e=this.setIsSvg(e||this.isSvg),this._element=e?document.createElementNS("http://www.w3.org/2000/svg",this.type):document.createElement(this.type);for(let e=0;e<this.children.length;e++){let t=A.resolve(this.children[e]);if(this.children[e]&&this.children[e][n])this.states.push(this.children[e]),this.references.has(this.children[e])||this.references.set(this.children[e],[]),this.references.get(this.children[e]).push(t),this._element.appendChild(t);else if(this.children[e]instanceof Function){this.childrefs[e]=new N(this.children[e]);let t=this.childrefs[e]._elements;for(let e=0;e<t.length;e++)this._element.appendChild(t[e]._element)}else t&&this._element.appendChild(t)}const t=Object.keys(this.props);if(this.props)for(let e=0;e<t.length;e++){const r=t[e];if(this.props[r]&&this.props[r][n])this.states.push(this.props[r]),this.references.has(this.props[r])||this.references.set(this.props[r],[]),this.references.get(this.props[r]).push(r);else if("object"==typeof this.props[r]){const e=w(this.props[r]);for(let t=0;t<e.length;t++)e[t].addRelient(this),this.states.push(e[t]),this.references.has(e[t])||this.references.set(e[t],[]),this.references.get(e[t]).push(r)}}for(let r=0;r<t.length;r++){const s=t[r];if("ref"!=s)if(this.props[s]&&this.props[s][n])this._element[s]=this.props[s].value;else if("object"==typeof this.props[s])"children"!=s&&k(this._element[s],this.props[s]);else try{"on"==s.substr(0,2)?this._element.addEventListener(s.substr(2),this.props[s]):(this._element[s]=this.props[s],e&&this._element.setAttribute(s,this.props[s]))}catch(e){this._element.setAttribute(s,this.props[s])}}for(let e=0;e<this.states.length;e++)this.states[e].addRelient(this);this.props.ref&&this.props.ref[y]&&this.props.ref.setRef(this)}setRelientStateDirty(e){const t=this.references.get(e);for(let r=0;r<t.length;r++){const s=t[r];s instanceof Text?s.textContent=e.value:s instanceof HTMLSpanElement&&s.hasAttribute("is-state-wrapper")?(e.hasRelatedNodes()&&e.relatedNodes.forEach(t=>{e.relatedNodes.includes(t)||t.element().remove()}),e.value.forEach(e=>{s.appendChild(e.element())})):"string"==typeof s&&(this.props[s]&&this.props[s][n]?this.element()[s]=this.props[s].value:this.props[s]instanceof Object&&k(this.element()[s],this.props[s]))}j("domrenderend",this)}static resolve(e){if(e instanceof A)return e.element();if(void 0!=e&&e[n]){if(e.value&&e.value.constructor===Array){let t=document.createElement("span");t.setAttribute("is-state-wrapper","true");for(let r=0;r<e.value.length;r++)t.appendChild(A.resolve(e.value[r]));return t}return e[p]?e.renderInternal():document.createTextNode(e.value)}return null!=e&&"object"==typeof e&&Object.getPrototypeOf(e)instanceof u?e.element():null!=e?document.createTextNode(void 0!=e?e:" "):void 0}get isVElement(){return!0}diff(e){if(void 0===e)return this.element().parentElement.removeChild(this.element());if(!C(this.props,e.props)){const t=Object.keys(this.props),r=Object.keys(e.props);for(let n=0;n<Math.max(t.length,r.length);n++){let s=t[n],i=r[n];"children"!==i&&(s&&i?this.props[s]!=e.props[s]&&(this.element()[s]=e.props[s]):s?i||delete this.element()[s]:this.element()[i]=e.props[i])}}if(this.props=e.props,e.children.length!=this.children.length){const t=this.element().parentElement;t&&(t.insertBefore(e.element(),this.element()),t.removeChild(this.element()),this._element=e.element(),this.children=e.children)}else this.children.forEach((t,r)=>{if(t&&t.diff&&"string"!=typeof e.children[r])t.diff(e.children[r]);else if(t!=e.children[r]){const t=this.element().parentElement;t&&e.element()&&this.element()!=e._element&&(t.insertBefore(e.element(),this.element()),t.removeChild(this.element()),this._element=e.element(),this.children=e.children)}})}}function C(e,t){if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;if(e.constructor!==t.constructor)return!1;for(var r in e)if(e.hasOwnProperty(r)){if(!t.hasOwnProperty(r))return!1;if(e[r]!==t[r]){if("object"!=typeof e[r])return!1;if(!C(e[r],t[r]))return!1}}for(r in t)if(t.hasOwnProperty(r)&&!e.hasOwnProperty(r))return!1;return!0}function D(e,t,...r){let n=null;return j("vdomcreate",n="function"==typeof e?Object.getPrototypeOf(e)===u?new e(Object.assign(Object.assign({},t||{}),{children:r})):e(Object.assign(Object.assign({},t||{}),{children:r})):new A(e,t,r)),n}const F=document.createElement("style");function P(e,t){if("string"==typeof e)return e;let r="";for(let n=0;n<e.length;n++)r+=e[n]||"",r+=t[n]||"";return r}F.setAttribute("fw-style","true"),document.head?document.head.appendChild(F):document.addEventListener("load",()=>{document.head.appendChild(F)});let M=0;function T(e,...t){const r=P(e,t);F.innerHTML+=`/*${M++}*/${r}`.replace(/\n/g,"")}var $={dom:D,StatefulData:i,stateJoin:o,css:T,Component:u,verbose:b,Ref:_};export default $;export{u as Component,s as OStatefulData,_ as Ref,i as StatefulData,N as VChildRegion,A as VElement,T as css,D as dom,j as executeHook,w as findStateDeep,O as getHooks,p as isComponentConstructor,y as isRef,n as isState,v as production,E as registerHook,o as stateJoin,R as subscribeToHook};