"use strict";function e(t,n,s){let o;return"#text"===t.nodeName?o=s.document.createTextNode(t.data):"#comment"===t.nodeName?o=s.document.createComment(t.data):("svg"===t.nodeName||n?(o=s.document.createElementNS("http://www.w3.org/2000/svg",t.nodeName),n=!0):o=s.document.createElement(t.nodeName),t.attributes&&Object.entries(t.attributes).forEach(([e,t])=>o.setAttribute(e,t)),t.childNodes&&t.childNodes.forEach(t=>o.appendChild(e(t,n,s))),s.valueDiffing&&(t.value&&(o.value=t.value),t.checked&&(o.checked=t.checked),t.selected&&(o.selected=t.selected))),o}function t(e,t){for(t=t.slice();t.length>0;){if(!e.childNodes)return!1;const n=t.splice(0,1)[0];e=e.childNodes[n]}return e}function n(n,s,o){let i,l,a,r,c,h=t(n,s[o._const.route]);const u={diff:s,node:h};if(o.preDiffApply(u))return!0;switch(s[o._const.action]){case o._const.addAttribute:if(!h||!h.setAttribute)return!1;h.setAttribute(s[o._const.name],s[o._const.value]);break;case o._const.modifyAttribute:if(!h||!h.setAttribute)return!1;h.setAttribute(s[o._const.name],s[o._const.newValue]),"INPUT"===h.nodeName&&"value"===s[o._const.name]&&(h.value=s[o._const.newValue]);break;case o._const.removeAttribute:if(!h||!h.removeAttribute)return!1;h.removeAttribute(s[o._const.name]);break;case o._const.modifyTextElement:if(!h||3!==h.nodeType)return!1;o.textDiff(h,h.data,s[o._const.oldValue],s[o._const.newValue]);break;case o._const.modifyValue:if(!h||void 0===h.value)return!1;h.value=s[o._const.newValue];break;case o._const.modifyComment:if(!h||void 0===h.data)return!1;o.textDiff(h,h.data,s[o._const.oldValue],s[o._const.newValue]);break;case o._const.modifyChecked:if(!h||void 0===h.checked)return!1;h.checked=s[o._const.newValue];break;case o._const.modifySelected:if(!h||void 0===h.selected)return!1;h.selected=s[o._const.newValue];break;case o._const.replaceElement:h.parentNode.replaceChild(e(s[o._const.newValue],"http://www.w3.org/2000/svg"===h.namespaceURI,o),h);break;case o._const.relocateGroup:(r=Array(...new Array(s.groupLength)).map(()=>h.removeChild(h.childNodes[s[o._const.from]]))).forEach((e,t)=>{0===t&&(l=h.childNodes[s[o._const.to]]),h.insertBefore(e,l||null)});break;case o._const.removeElement:h.parentNode.removeChild(h);break;case o._const.addElement:c=(a=s[o._const.route].slice()).splice(a.length-1,1)[0],(h=t(n,a)).insertBefore(e(s[o._const.element],"http://www.w3.org/2000/svg"===h.namespaceURI,o),h.childNodes[c]||null);break;case o._const.removeTextElement:if(!h||3!==h.nodeType)return!1;h.parentNode.removeChild(h);break;case o._const.addTextElement:if(c=(a=s[o._const.route].slice()).splice(a.length-1,1)[0],i=o.document.createTextNode(s[o._const.value]),!(h=t(n,a))||!h.childNodes)return!1;h.insertBefore(i,h.childNodes[c]||null);break;default:console.log("unknown action")}return u.newNode=i,o.postDiffApply(u),!0}function s(e,t,s){return t.every(t=>n(e,t,s))}function o(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function i(e,t,s){switch(t[s._const.action]){case s._const.addAttribute:t[s._const.action]=s._const.removeAttribute,n(e,t,s);break;case s._const.modifyAttribute:o(t,s._const.oldValue,s._const.newValue),n(e,t,s);break;case s._const.removeAttribute:t[s._const.action]=s._const.addAttribute,n(e,t,s);break;case s._const.modifyTextElement:case s._const.modifyValue:case s._const.modifyComment:case s._const.modifyChecked:case s._const.modifySelected:case s._const.replaceElement:o(t,s._const.oldValue,s._const.newValue),n(e,t,s);break;case s._const.relocateGroup:o(t,s._const.from,s._const.to),n(e,t,s);break;case s._const.removeElement:t[s._const.action]=s._const.addElement,n(e,t,s);break;case s._const.addElement:t[s._const.action]=s._const.removeElement,n(e,t,s);break;case s._const.removeTextElement:t[s._const.action]=s._const.addTextElement,n(e,t,s);break;case s._const.addTextElement:t[s._const.action]=s._const.removeTextElement,n(e,t,s);break;default:console.log("unknown action")}}function l(e,t,n){t.length||(t=[t]),(t=t.slice()).reverse(),t.forEach(t=>{i(e,t,n)})}class a{constructor(e={}){Object.entries(e).forEach(([e,t])=>this[e]=t)}toString(){return JSON.stringify(this)}setValue(e,t){return this[e]=t,this}}function r(e){const t=[];return"#text"!==e.nodeName&&"#comment"!==e.nodeName&&(t.push(e.nodeName),e.attributes&&(e.attributes.class&&t.push(`${e.nodeName}.${e.attributes.class.replace(/ /g,".")}`),e.attributes.id&&t.push(`${e.nodeName}#${e.attributes.id}`))),t}function c(e){const t={},n={};return e.forEach(e=>{r(e).forEach(e=>{const s=e in t;s||e in n?s&&(delete t[e],n[e]=!0):t[e]=!0})}),t}function h(e,t){const n=c(e),s=c(t),o={};return Object.keys(n).forEach(e=>{s[e]&&(o[e]=!0)}),o}function u(e){return delete e.outerDone,delete e.innerDone,delete e.valueDone,!e.childNodes||e.childNodes.every(u)}function d(e,t){if(!["nodeName","value","checked","selected","data"].every(n=>e[n]===t[n]))return!1;if(Boolean(e.attributes)!==Boolean(t.attributes))return!1;if(Boolean(e.childNodes)!==Boolean(t.childNodes))return!1;if(e.attributes){const n=Object.keys(e.attributes),s=Object.keys(t.attributes);if(n.length!==s.length)return!1;if(!n.every(n=>e.attributes[n]===t.attributes[n]))return!1}if(e.childNodes){if(e.childNodes.length!==t.childNodes.length)return!1;if(!e.childNodes.every((e,n)=>d(e,t.childNodes[n])))return!1}return!0}function f(e,t,n,s,o){if(!e||!t)return!1;if(e.nodeName!==t.nodeName)return!1;if("#text"===e.nodeName)return!!o||e.data===t.data;if(e.nodeName in n)return!0;if(e.attributes&&t.attributes){if(e.attributes.id){if(e.attributes.id!==t.attributes.id)return!1;if(`${e.nodeName}#${e.attributes.id}`in n)return!0}if(e.attributes.class&&e.attributes.class===t.attributes.class){if(`${e.nodeName}.${e.attributes.class.replace(/ /g,".")}`in n)return!0}}if(s)return!0;const i=e.childNodes?e.childNodes.slice().reverse():[],l=t.childNodes?t.childNodes.slice().reverse():[];if(i.length!==l.length)return!1;if(o)return i.every((e,t)=>e.nodeName===l[t].nodeName);{const e=h(i,l);return i.every((t,n)=>f(t,l[n],e,!0,!0))}}function p(e){return JSON.parse(JSON.stringify(e))}function m(e,t,n,s){let o=0,i=[];const l=e.length,a=t.length,c=Array(...new Array(l+1)).map(()=>[]),u=h(e,t);let d=l===a;d&&e.some((e,n)=>{const s=r(e),o=r(t[n]);return s.length!==o.length?(d=!1,!0):(s.some((e,t)=>{if(e!==o[t])return d=!1,!0}),!d||void 0)});for(let r=0;r<l;r++){const l=e[r];for(let e=0;e<a;e++){const a=t[e];n[r]||s[e]||!f(l,a,u,d)?c[r+1][e+1]=0:(c[r+1][e+1]=c[r][e]?c[r][e]+1:1,c[r+1][e+1]>=o&&(o=c[r+1][e+1],i=[r+1,e+1]))}}return 0!==o&&{oldValue:i[0]-o,newValue:i[1]-o,length:o}}function g(e,t){return Array(...new Array(e)).map(()=>t)}function _(e,t,n){const s=e.childNodes?g(e.childNodes.length,!0):[],o=t.childNodes?g(t.childNodes.length,!0):[];let i=0;return n.forEach(e=>{const t=e.oldValue+e.length,n=e.newValue+e.length;for(let n=e.oldValue;n<t;n+=1)s[n]=i;for(let t=e.newValue;t<n;t+=1)o[t]=i;i+=1}),{gaps1:s,gaps2:o}}function b(e,t){const n=e.childNodes?e.childNodes:[],s=t.childNodes?t.childNodes:[],o=g(n.length,!1),i=g(s.length,!1),l=[];let a=!0;const r=function(){return arguments[1]};for(;a;)if(a=m(n,s,o,i)){l.push(a),Array(...new Array(a.length)).map(r).forEach(e=>(c=e,o[a.oldValue+c]=!0,void(i[a.newValue+c]=!0)))}var c;return e.subsets=l,e.subsetsAge=100,l}class V{constructor(){this.list=[]}add(e){this.list.push(...e)}forEach(e){this.list.forEach(t=>e(t))}}function N(e,t){let n,s,o=e;for(t=t.slice();t.length>0;){if(!o.childNodes)return!1;s=t.splice(0,1)[0],n=o,o=o.childNodes[s]}return{node:o,parentNode:n,nodeIndex:s}}function y(e,t,n){const s=N(e,t[n._const.route]);let o=s.node;const i=s.parentNode,l=s.nodeIndex,a=[],r={diff:t,node:o};if(n.preDiffApply(r))return!0;let c,h,u,d;switch(t[n._const.action]){case n._const.addAttribute:o.attributes||(o.attributes={}),o.attributes[t[n._const.name]]=t[n._const.value],"checked"===t[n._const.name]?o.checked=!0:"selected"===t[n._const.name]?o.selected=!0:"INPUT"===o.nodeName&&"value"===t[n._const.name]&&(o.value=t[n._const.value]);break;case n._const.modifyAttribute:o.attributes[t[n._const.name]]=t[n._const.newValue];break;case n._const.removeAttribute:delete o.attributes[t[n._const.name]],0===Object.keys(o.attributes).length&&delete o.attributes,"checked"===t[n._const.name]?o.checked=!1:"selected"===t[n._const.name]?delete o.selected:"INPUT"===o.nodeName&&"value"===t[n._const.name]&&delete o.value;break;case n._const.modifyTextElement:o.data=t[n._const.newValue];break;case n._const.modifyValue:o.value=t[n._const.newValue];break;case n._const.modifyComment:o.data=t[n._const.newValue];break;case n._const.modifyChecked:o.checked=t[n._const.newValue];break;case n._const.modifySelected:o.selected=t[n._const.newValue];break;case n._const.replaceElement:(c=p(t[n._const.newValue])).outerDone=!0,c.innerDone=!0,c.valueDone=!0,i.childNodes[l]=c;break;case n._const.relocateGroup:(h=o.childNodes.splice(t[n._const.from],t.groupLength).reverse()).forEach(e=>o.childNodes.splice(t[n._const.to],0,e)),o.subsets&&o.subsets.forEach(e=>{if(t[n._const.from]<t[n._const.to]&&e.oldValue<=t[n._const.to]&&e.oldValue>t[n._const.from]){e.oldValue-=t.groupLength;const s=e.oldValue+e.length-t[n._const.to];s>0&&(a.push({oldValue:t[n._const.to]+t.groupLength,newValue:e.newValue+e.length-s,length:s}),e.length-=s)}else if(t[n._const.from]>t[n._const.to]&&e.oldValue>t[n._const.to]&&e.oldValue<t[n._const.from]){e.oldValue+=t.groupLength;const s=e.oldValue+e.length-t[n._const.to];s>0&&(a.push({oldValue:t[n._const.to]+t.groupLength,newValue:e.newValue+e.length-s,length:s}),e.length-=s)}else e.oldValue===t[n._const.from]&&(e.oldValue=t[n._const.to])});break;case n._const.removeElement:i.childNodes.splice(l,1),i.subsets&&i.subsets.forEach(e=>{e.oldValue>l?e.oldValue-=1:e.oldValue===l?e.delete=!0:e.oldValue<l&&e.oldValue+e.length>l&&(e.oldValue+e.length-1===l?e.length--:(a.push({newValue:e.newValue+l-e.oldValue,oldValue:l,length:e.length-l+e.oldValue-1}),e.length=l-e.oldValue))}),o=i;break;case n._const.addElement:u=t[n._const.route].slice(),d=u.splice(u.length-1,1)[0],o=N(e,u).node,(c=p(t[n._const.element])).outerDone=!0,c.innerDone=!0,c.valueDone=!0,o.childNodes||(o.childNodes=[]),d>=o.childNodes.length?o.childNodes.push(c):o.childNodes.splice(d,0,c),o.subsets&&o.subsets.forEach(e=>{if(e.oldValue>=d)e.oldValue+=1;else if(e.oldValue<d&&e.oldValue+e.length>d){const t=e.oldValue+e.length-d;a.push({newValue:e.newValue+e.length-t,oldValue:d+1,length:t}),e.length-=t}});break;case n._const.removeTextElement:i.childNodes.splice(l,1),"TEXTAREA"===i.nodeName&&delete i.value,i.subsets&&i.subsets.forEach(e=>{e.oldValue>l?e.oldValue-=1:e.oldValue===l?e.delete=!0:e.oldValue<l&&e.oldValue+e.length>l&&(e.oldValue+e.length-1===l?e.length--:(a.push({newValue:e.newValue+l-e.oldValue,oldValue:l,length:e.length-l+e.oldValue-1}),e.length=l-e.oldValue))}),o=i;break;case n._const.addTextElement:u=t[n._const.route].slice(),d=u.splice(u.length-1,1)[0],(c={}).nodeName="#text",c.data=t[n._const.value],(o=N(e,u).node).childNodes||(o.childNodes=[]),d>=o.childNodes.length?o.childNodes.push(c):o.childNodes.splice(d,0,c),"TEXTAREA"===o.nodeName&&(o.value=t[n._const.newValue]),o.subsets&&o.subsets.forEach(e=>{if(e.oldValue>=d&&(e.oldValue+=1),e.oldValue<d&&e.oldValue+e.length>d){const t=e.oldValue+e.length-d;a.push({newValue:e.newValue+e.length-t,oldValue:d+1,length:t}),e.length-=t}});break;default:console.log("unknown action")}o.subsets&&(o.subsets=o.subsets.filter(e=>!e.delete&&e.oldValue!==e.newValue),a.length&&(o.subsets=o.subsets.concat(a))),r.newNode=c,n.postDiffApply(r)}function v(e,t,n){return t.forEach(t=>{y(e,t,n)}),!0}function w(e,t={}){const n={};if(n.nodeName=e.nodeName,"#text"===n.nodeName||"#comment"===n.nodeName)n.data=e.data;else{if(e.attributes&&e.attributes.length>0){n.attributes={},Array.prototype.slice.call(e.attributes).forEach(e=>n.attributes[e.name]=e.value)}if("TEXTAREA"===n.nodeName)n.value=e.value;else if(e.childNodes&&e.childNodes.length>0){n.childNodes=[],Array.prototype.slice.call(e.childNodes).forEach(e=>n.childNodes.push(w(e,t)))}t.valueDiffing&&(void 0!==e.checked&&e.type&&["radio","checkbox"].includes(e.type.toLowerCase())?n.checked=e.checked:void 0!==e.value&&(n.value=e.value),void 0!==e.selected&&(n.selected=e.selected))}return n}const k=/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>/g,E=Object.create?Object.create(null):{},x=/([\w-:]+)|(['"])([^'"]*)\2/g,D={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuItem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};function A(e){let t,n=0;const s={nodeName:""};return e.replace(x,o=>{n%2?t=o:0===n?((D[o]||"/"===e.charAt(e.length-2))&&(s.voidElement=!0),s.nodeName=o.toUpperCase()):(s.attributes||(s.attributes={}),s.attributes[t]=o.replace(/^['"]|['"]$/g,"")),n++}),s}function O(e,t={components:E}){const n=[];let s,o=-1;const i=[],l={};let a=!1;return e.replace(k,(r,c)=>{if(a){if(r!==`</${s.nodeName}>`)return;a=!1}const h="/"!==r.charAt(1),u=c+r.length,d=e.charAt(u);let f;if(h&&(o++,"tag"===(s=A(r)).type&&t.components[s.nodeName]&&(s.type="component",a=!0),s.voidElement||a||!d||"<"===d||(s.childNodes||(s.childNodes=[]),s.childNodes.push({nodeName:"#text",data:e.slice(u,e.indexOf("<",u))})),l[s.tagName]=s,0===o&&n.push(s),(f=i[o-1])&&(f.childNodes||(f.childNodes=[]),f.childNodes.push(s)),i[o]=s),(!h||s.voidElement)&&(o--,!a&&"<"!==d&&d)){f=-1===o?n:i[o].childNodes||[];const t=e.indexOf("<",u),s=e.slice(u,-1===t?void 0:t);f.push({nodeName:"#text",data:s})}}),n[0]}function C(e){return delete e.voidElement,e.childNodes&&e.childNodes.forEach(e=>C(e)),e}function T(e){return C(O(e))}class S{constructor(e,t,n){this.options=n,this.t1=e instanceof HTMLElement?w(e,this.options):"string"==typeof e?T(e,this.options):JSON.parse(JSON.stringify(e)),this.t2=t instanceof HTMLElement?w(t,this.options):"string"==typeof t?T(t,this.options):JSON.parse(JSON.stringify(t)),this.diffcount=0,this.foundAll=!1,this.debug&&(this.t1Orig=w(e,this.options),this.t2Orig=w(t,this.options)),this.tracker=new V}init(){return this.findDiffs(this.t1,this.t2)}findDiffs(e,t){let n;do{if(this.options.debug&&(this.diffcount+=1,this.diffcount>this.options.diffcap))throw window.diffError=[this.t1Orig,this.t2Orig],new Error(`surpassed diffcap:${JSON.stringify(this.t1Orig)} -> ${JSON.stringify(this.t2Orig)}`);0===(n=this.findNextDiff(e,t,[])).length&&(d(e,t)||(this.foundAll?console.error("Could not find remaining diffs!"):(this.foundAll=!0,u(e),n=this.findNextDiff(e,t,[])))),n.length>0&&(this.foundAll=!1,this.tracker.add(n),v(e,n,this.options))}while(n.length>0);return this.tracker.list}findNextDiff(e,t,n){let s,o;if(this.options.maxDepth&&n.length>this.options.maxDepth)return[];if(!e.outerDone){if(s=this.findOuterDiff(e,t,n),this.options.filterOuterDiff&&(o=this.options.filterOuterDiff(e,t,s))&&(s=o),s.length>0)return e.outerDone=!0,s;e.outerDone=!0}if(!e.innerDone){if((s=this.findInnerDiff(e,t,n)).length>0)return s;e.innerDone=!0}if(this.options.valueDiffing&&!e.valueDone){if((s=this.findValueDiff(e,t,n)).length>0)return e.valueDone=!0,s;e.valueDone=!0}return[]}findOuterDiff(e,t,n){const s=[];let o,i,l,r,c,h;if(e.nodeName!==t.nodeName){if(!n.length)throw new Error("Top level nodes have to be of the same kind.");return[(new a).setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,p(e)).setValue(this.options._const.newValue,p(t)).setValue(this.options._const.route,n)]}if(n.length&&this.options.maxNodeDiffCount<Math.abs((e.childNodes||[]).length-(t.childNodes||[]).length))return[(new a).setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,p(e)).setValue(this.options._const.newValue,p(t)).setValue(this.options._const.route,n)];if(e.data!==t.data)return"#text"===e.nodeName?[(new a).setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,n).setValue(this.options._const.oldValue,e.data).setValue(this.options._const.newValue,t.data)]:[(new a).setValue(this.options._const.action,this.options._const.modifyComment).setValue(this.options._const.route,n).setValue(this.options._const.oldValue,e.data).setValue(this.options._const.newValue,t.data)];for(i=e.attributes?Object.keys(e.attributes).sort():[],l=t.attributes?Object.keys(t.attributes).sort():[],r=i.length,h=0;h<r;h++)o=i[h],-1===(c=l.indexOf(o))?s.push((new a).setValue(this.options._const.action,this.options._const.removeAttribute).setValue(this.options._const.route,n).setValue(this.options._const.name,o).setValue(this.options._const.value,e.attributes[o])):(l.splice(c,1),e.attributes[o]!==t.attributes[o]&&s.push((new a).setValue(this.options._const.action,this.options._const.modifyAttribute).setValue(this.options._const.route,n).setValue(this.options._const.name,o).setValue(this.options._const.oldValue,e.attributes[o]).setValue(this.options._const.newValue,t.attributes[o])));for(r=l.length,h=0;h<r;h++)o=l[h],s.push((new a).setValue(this.options._const.action,this.options._const.addAttribute).setValue(this.options._const.route,n).setValue(this.options._const.name,o).setValue(this.options._const.value,t.attributes[o]));return s}findInnerDiff(e,t,n){const s=e.childNodes?e.childNodes.slice():[],o=t.childNodes?t.childNodes.slice():[],i=Math.max(s.length,o.length);let l=Math.abs(s.length-o.length),r=[],c=0;if(!this.options.maxChildCount||i<this.options.maxChildCount){const s=e.subsets&&e.subsetsAge--?e.subsets:e.childNodes&&t.childNodes?b(e,t):[];if(s.length>0&&(r=this.attemptGroupRelocation(e,t,s,n)).length>0)return r}for(let e=0;e<i;e+=1){const t=s[e],h=o[e];l&&(t&&!h?"#text"===t.nodeName?(r.push((new a).setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,n.concat(c)).setValue(this.options._const.value,t.data)),c-=1):(r.push((new a).setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,n.concat(c)).setValue(this.options._const.element,p(t))),c-=1):h&&!t&&("#text"===h.nodeName?r.push((new a).setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,n.concat(c)).setValue(this.options._const.value,h.data)):r.push((new a).setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,n.concat(c)).setValue(this.options._const.element,p(h))))),t&&h&&(!this.options.maxChildCount||i<this.options.maxChildCount?r=r.concat(this.findNextDiff(t,h,n.concat(c))):d(t,h)||(s.length>o.length?(r=r.concat([(new a).setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.element,p(t)).setValue(this.options._const.route,n.concat(c))]),s.splice(e,1),c-=1,l-=1):s.length<o.length?(r=r.concat([(new a).setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.element,p(h)).setValue(this.options._const.route,n.concat(c))]),s.splice(e,0,{}),l-=1):r=r.concat([(new a).setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,p(t)).setValue(this.options._const.newValue,p(h)).setValue(this.options._const.route,n.concat(c))]))),c+=1}return e.innerDone=!0,r}attemptGroupRelocation(e,t,n,s){const o=_(e,t,n),i=o.gaps1,l=o.gaps2;let r,c,h,u,d,m,g=Math.min(i.length,l.length);const b=[];for(let o=0,_=0;o<g;_+=1,o+=1)if(!0===i[o])if("#text"===(u=e.childNodes[_]).nodeName){if("#text"===t.childNodes[o].nodeName&&u.data!==t.childNodes[o].data){for(m=_;e.childNodes.length>m+1&&"#text"===e.childNodes[m+1].nodeName;)if(m+=1,t.childNodes[o].data===e.childNodes[m].data){d=!0;break}if(!d)return b.push((new a).setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,s.concat(o)).setValue(this.options._const.oldValue,u.data).setValue(this.options._const.newValue,t.childNodes[o].data)),b}b.push((new a).setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,s.concat(o)).setValue(this.options._const.value,u.data)),i.splice(o,1),g=Math.min(i.length,l.length),o-=1}else b.push((new a).setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,s.concat(o)).setValue(this.options._const.element,p(u))),i.splice(o,1),g=Math.min(i.length,l.length),o-=1;else if(!0===l[o])"#text"===(u=t.childNodes[o]).nodeName?(b.push((new a).setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,s.concat(o)).setValue(this.options._const.value,u.data)),i.splice(o,0,!0),g=Math.min(i.length,l.length),_-=1):(b.push((new a).setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,s.concat(o)).setValue(this.options._const.element,p(u))),i.splice(o,0,!0),g=Math.min(i.length,l.length),_-=1);else if(i[o]!==l[o]){if(b.length>0)return b;if(h=n[i[o]],(c=Math.min(h.newValue,e.childNodes.length-h.length))!==h.oldValue){r=!1;for(let t=0;t<h.length;t+=1)f(e.childNodes[c+t],e.childNodes[h.oldValue+t],[],!1,!0)||(r=!0);if(r)return[(new a).setValue(this.options._const.action,this.options._const.relocateGroup).setValue("groupLength",h.length).setValue(this.options._const.from,h.oldValue).setValue(this.options._const.to,c).setValue(this.options._const.route,s)]}}return b}findValueDiff(e,t,n){const s=[];return e.selected!==t.selected&&s.push((new a).setValue(this.options._const.action,this.options._const.modifySelected).setValue(this.options._const.oldValue,e.selected).setValue(this.options._const.newValue,t.selected).setValue(this.options._const.route,n)),(e.value||t.value)&&e.value!==t.value&&"OPTION"!==e.nodeName&&s.push((new a).setValue(this.options._const.action,this.options._const.modifyValue).setValue(this.options._const.oldValue,e.value||"").setValue(this.options._const.newValue,t.value||"").setValue(this.options._const.route,n)),e.checked!==t.checked&&s.push((new a).setValue(this.options._const.action,this.options._const.modifyChecked).setValue(this.options._const.oldValue,e.checked).setValue(this.options._const.newValue,t.checked).setValue(this.options._const.route,n)),s}}const R={debug:!1,diffcap:10,maxDepth:!1,maxChildCount:50,valueDiffing:!0,textDiff(e,t,n,s){e.data=s},preVirtualDiffApply(){},postVirtualDiffApply(){},preDiffApply(){},postDiffApply(){},filterOuterDiff:null,compress:!1,_const:!1,document:!(!window||!window.document)&&window.document};class j{constructor(e={}){if(this.options=e,Object.entries(R).forEach(([e,t])=>{Object.prototype.hasOwnProperty.call(this.options,e)||(this.options[e]=t)}),!this.options._const){const e=["addAttribute","modifyAttribute","removeAttribute","modifyTextElement","relocateGroup","removeElement","addElement","removeTextElement","addTextElement","replaceElement","modifyValue","modifyChecked","modifySelected","modifyComment","action","route","oldValue","newValue","element","group","from","to","name","value","data","attributes","nodeName","childNodes","checked","selected"];this.options._const={},this.options.compress?e.forEach((e,t)=>this.options._const[e]=t):e.forEach(e=>this.options._const[e]=e)}this.DiffFinder=S}apply(e,t){return s(e,t,this.options)}undo(e,t){return l(e,t,this.options)}diff(e,t){return new this.DiffFinder(e,t,this.options).init()}}const M=Symbol();class I{constructor(e){this._relientObjects=[],this.relatedNodes=[],this._value=e}hasRelatedNodes(){return this.relatedNodes.length>0}addRelient(e){this._relientObjects.push(e)}get value(){return this._value}set value(e){this._value=e,e&&e.constructor===Array?(this.relatedNodes=[],e.forEach(e=>{e.isVElement&&this.relatedNodes.push(e)})):e&&e.isVElement&&(this.relatedNodes=[e]);for(let e=0;e<this._relientObjects.length;e++)this._relientObjects[e].setRelientStateDirty(this)}get[M](){return!0}[Symbol.iterator](){return function*(e){yield e}(this._value)}}function G(e){return new I(e)}function L(...e){let t=[],n={get value(){let t="";for(let n=0;n<e.length;n++)e[n]&&e[n][M]?t+=e[n].value:e[n]&&(t+=e[n]);return t},addRelient(e){t.push(e)},setRelientStateDirty(){t.forEach(function(e){e.setRelientStateDirty&&e.setRelientStateDirty(n)})},[M]:!0};for(let t=0;t<e.length;t++)e[t]&&e[t][M]&&e[t].addRelient(n);return n}class F{constructor(){this.funcs={log:console.log.bind(null)},this.enabled=!1}log(...e){this.enabled&&this.funcs.log(...e)}}var P,B=new F;const $=[],J={timeout:500},z=requestIdleCallback||requestAnimationFrame;function U(){let e=$.shift();e&&B.log("handling rerender for",e,"resulting in",e.rerender()),z(U,J)}z(U,J);const H=Symbol();class W{constructor(e){if(this.WARNIFINRENDER=0,this._initialized=!1,this._relient=[],this[P]=!0,this.props=e,!this.renderFunctionExists())throw new Error("Components must define a render function")}renderFunctionExists(){return this.render instanceof Function}renderInternal(){if(!this._initialized){let e=Object.keys(this);for(let t=0;t<e.length;t++)this[e[t]][M]&&this[e[t]].addRelient(this);this._initialized=!0}this.WARNIFINRENDER++;let e=this.render();return this.WARNIFINRENDER--,this._element?this._element.diff(e):this._element=e,this._element.element}get element(){return this.renderInternal()}render(){}rerender(){if(this.WARNIFINRENDER&&console.warn("rerender initiated from within the render call, this should be avoided if posible"),this.WARNIFINRENDER>10)return console.error("rerender error: rerender is being called within render several times in a row, this most likeally means that there is an issue."),null;return this.renderInternal()}addRelient(e){this._relient.includes(e)||this._relient.push(e)}setRelientStateDirty(e){$.includes(this)||$.push(this)}get[(P=H,M)](){return!0}}const q="animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistantLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,script,set,solidcolor,stop,style,svg,switch,symbol,text,textPath,title,tspan,unknown,use,view,animate,animateColor,animateMotion,animateTransform,discard,mpath,set,circle,ellipse,line,polygon,polyline,rect,a,defs,g,marker,mask,missing-glyph,pattern,svg,switch,symbol,unknown,desc,metadata,title,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,feSpecularLighting,feTile,feTurbulence,font,font-face,font-face-format,font-face-name,font-face-src,font-face-uri,hkern,vkern,linearGradient,meshgradient,radialGradient,stop,circle,ellipse,image,line,mesh,path,polygon,polyline,rect,text,use,mesh,use,feDistantLight,fePointLight,feSpotLight,clipPath,defs,hatch,linearGradient,marker,mask,meshgradient,metadata,pattern,radialGradient,script,style,symbol,title,hatch,linearGradient,meshgradient,pattern,radialGradient,solidcolor,a,circle,ellipse,foreignObject,g,image,line,mesh,path,polygon,polyline,rect,svg,switch,symbol,text,textPath,tspan,unknown,use,circle,ellipse,line,mesh,path,polygon,polyline,rect,defs,g,svg,symbol,use,altGlyph,altGlyphDef,altGlyphItem,glyph,glyphRef,textPath,text,tref,tspan,altGlyph,textPath,tref,tspan,clipPath,color-profile,cursor,filter,foreignObject,hatchpath,meshpatch,meshrow,script,style,view,altGlyph,altGlyphDef,altGlyphItem,animateColor,cursor,font,font-face,font-face-format,font-face-name,font-face-src,font-face-uri,glyph,glyphRef,hkern,missing-glyph,tref,vkern,a,altGlyph,altGlyphDef,altGlyphItem,animate,animateColor,animateMotion,animateTransform,circle,clipPath,color-profile,cursor,defs,desc,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistantLight,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,font,font-face,font-face-format,font-face-name,font-face-src,font-face-uri,foreignObject,g,glyph,glyphRef,hkern,image,line,linearGradient,marker,mask,metadata,missing-glyph,mpath,path,pattern,polygon,polyline,radialGradient,rect,script,set,stop,style,svg,switch,symbol,text,textPath,title,tref,tspan,use,view,vkern".split(","),X=new j;function Z(e){for(let t=0;t<e.length;t++)e[t]&&e[t].constructor===Array&&e.splice(t,1,...e[t]);return e}function K(e){let t=[];const n=Object.keys(e);for(let s=0;s<n.length;s++){const o=n[s];e[o]&&e[o][M]?t.push(e[o]):"object"==typeof e[o]&&t.push(...K(e[o]))}return t}function Q(e,t){const n=Object.keys(t);for(let s=0;s<n.length;s++){const o=n[s],i=t[o];i&&i[M]?e[o]=i.value:e[o]=i}}class Y{constructor(e){this.references=new Map,this.initializer=e,this.elements=[],this.elements instanceof Array||(this.elements=[this.elements]),this.render()}render(){for(let e=0;e<this.elements.length;e++)this.elements[e].element.remove();this.elements=this.initializer();for(let e=0;e<this.elements.length;e++){const t=[...this.elements[e].references.keys()];for(let n=0;n<t.length;n++)this.references.has(t[n])||this.references.set(t[n],[]),this.references.get(t[n]).push(this.elements[e]),t[n].addRelient(this)}}setRelientStateDirty(e){}}class ee{constructor(e,t,n){this.childrefs=[],this.references=new Map;const s=Z(n);this.type=e,this.props=t||{},this.children=s,this.states=[],q.includes(e)?this.element=document.createElementNS("http://www.w3.org/2000/svg",this.type):this.element=document.createElement(this.type);for(let e=0;e<this.children.length;e++){let t=ee.resolve(this.children[e]);if(this.children[e]&&this.children[e][M])this.states.push(this.children[e]),this.references.has(this.children[e])||this.references.set(this.children[e],[]),this.references.get(this.children[e]).push(t),this.element.appendChild(t);else if(this.children[e]instanceof Function){this.childrefs[e]=new Y(this.children[e]);let t=this.childrefs[e].elements;for(let e=0;e<t.length;e++)this.element.appendChild(t[e].element)}else t&&this.element.appendChild(t)}const o=Object.keys(this.props);if(this.props)for(let e=0;e<o.length;e++){const t=o[e];if(this.props[t]&&this.props[t][M])this.states.push(this.props[t]),this.references.has(this.props[t])||this.references.set(this.props[t],[]),this.references.get(this.props[t]).push(t);else if("object"==typeof this.props[t]){const e=K(this.props[t]);for(let n=0;n<e.length;n++)e[n].addRelient(this),this.states.push(e[n]),this.references.has(e[n])||this.references.set(e[n],[]),this.references.get(e[n]).push(t)}}for(let e=0;e<o.length;e++){const n=o[e];if(this.props[n]&&this.props[n][M])this.element[n]=t[n].value;else if("object"==typeof t[n])Q(this.element[n],t[n]),"on"!==n.substr(0,2)&&this.element.setAttribute(n,this.element[n].value);else{try{this.element[n]=t[n]}catch(e){}"on"!==n.substr(0,2)&&this.element.setAttribute(n,this.element[n])}}for(let e=0;e<this.states.length;e++)this.states[e].addRelient(this)}setRelientStateDirty(e){const t=this.references.get(e);for(let n=0;n<t.length;n++){const s=t[n];s instanceof Text?s.textContent=e.value:s instanceof HTMLSpanElement&&s.hasAttribute("is-state-wrapper")?(e.hasRelatedNodes()&&e.relatedNodes.forEach(t=>{e.relatedNodes.includes(t)||t.element.remove()}),e.value.forEach(e=>{s.appendChild(e.element)})):"string"==typeof s&&(this.props[s]&&this.props[s][M]?this.element[s]=this.props[s].value:this.props[s]instanceof Object&&Q(this.element[s],this.props[s]))}}static resolve(e){if(e instanceof ee)return e.element;if(void 0!=e&&e[M]){if(e.value&&e.value.constructor===Array){let t=document.createElement("span");t.setAttribute("is-state-wrapper","true");for(let n=0;n<e.value.length;n++)t.appendChild(ee.resolve(e.value[n]));return t}return e[H]?e.renderInternal():document.createTextNode(e.value)}return null!=e&&Object.getPrototypeOf(e)instanceof W?e.element:null!=e?document.createTextNode(void 0!=e?e:" "):void 0}get isVElement(){return!0}diff(e){return X.apply(this.element,X.diff(this.element,e.element))}}function te(e,t,...n){return"function"==typeof e?Object.getPrototypeOf(e)===W?new e(Object.assign({},t||{},{children:n})):e(Object.assign({},t||{},{children:n})):new ee(e,t,n)}const ne=document.createElement("style");ne.setAttribute("fw-style","true");const se=new Map;function oe(e){if(se.has(e)){const t=se.get(e)+1;return se.set(e,t),e+"-"+t}return se.set(e,0),e}function ie(e){let t={},n={},s=Object.keys(e);for(let o=0;o<s.length;o++){let i=s[o],l=oe(i);t[l]=e[i],n[i]=l}let o=[];function i(e,t){let n=[],s=Object.keys(e);for(let o=0;o<s.length;o++){let l=s[o];"object"==typeof e[l]?i(e[l],t+l):n.push(l.replace(/[A-Z]/g,e=>"-"+e.toLowerCase())+":"+e[l])}o.push(`${t}{${n.join(";")}}`)}let l=Object.keys(t);for(let e=0;e<l.length;e++)o.push(i(t[l[e]],l[e]));let a=o.join("\n");return ne.innerHTML+=a,n}ie.raw=function(e){ne.innerHTML+="/*raw*/\n\n"+e+"\n/*end raw*/\n"},document.head?document.head.appendChild(ne):document.addEventListener("load",()=>{document.head.appendChild(ne)});const le=ie;var ae={dom:te,StatefulData:G,stateJoin:L,makeStyles:le,Component:W,verbose:B};setTimeout(console.log.bind(console,"%cfw2gulp%cby%cIan Senne","color:gold;background-color:black;border-radius:3px 0px 0px 3px;padding:3px;font-size:32px","color:black;background-color:gray;padding:3px;font-size:32px","color:red;background-color:black;border-radius:0px 3px 3px 0px;padding:3px;font-size:32px")),document.querySelector("[fw-src]").remove();const{Component:re,StatefulData:ce}=ae;class he extends re{constructor(e){super(e),this.hours=ce(0),this.minutes=ce(0),this.seconds=ce(0),this.id=setInterval(this.updateTimes.bind(this),1e3)}updateTimes(){this.seconds.value++,this.seconds.value>59&&(this.seconds.value=0,this.minutes.value++),this.minutes.value>59&&(this.minutes.value=0,this.hours.value++)}render(){return ae.dom("h1",null,this.hours.value.toString().padStart(2,"0"),":",this.minutes.value.toString().padStart(2,"0"),":",this.seconds.value.toString().padStart(2,"0"))}}function ue(){return ae.dom("div",{className:"approot"},ae.dom(he,null))}ae.makeStyles({".approot":{width:"100vw",height:"100vh",top:0,left:0,margin:"0px",position:"absolute",color:"black"}});const de=ae.dom(ue,null);function fe(){document.body?document.body.appendChild(de.element):requestAnimationFrame(fe)}try{document.body.appendChild(de.element)}catch(e){fe()}