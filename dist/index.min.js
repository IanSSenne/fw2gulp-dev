if(Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var s=arguments[n];if(void 0!==s&&null!==s){s=Object(s);for(var r=Object.keys(Object(s)),i=0,l=r.length;i<l;i++){var h=r[i],o=Object.getOwnPropertyDescriptor(s,h);void 0!==o&&o.enumerable&&(t[h]=s[h])}}}return t}}),String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{enumerable:!1,value:function(e,t=-1){return this.filter(function(n,s){return n==e&&s>t}).length>0}}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(e){let t=[];for(let n=0;n<this.value;n++)t.push(e);return t}}),!t)var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0987654321!@#$%^&*()",t=function(t){let n=[];for(let t=0;t<128;t++)n.push(e[Math.floor(Math.random()*e.length)]);return"IESymbol("+n.join("")+(t||"")+")"};function n(e){return t(e)}n.$Symbol=function(){return t}.bind(window)();const s=n();class r{constructor(e){this._relientObjects=[],this.relatedNodes=[],this._value=e}hasRelatedNodes(){return this.relatedNodes.length>0}addRelient(e){this._relientObjects.push(e)}get value(){return this._value}set value(e){this._value=e,e&&e.constructor===Array?(this.relatedNodes=[],e.forEach(e=>{e.isVElement&&this.relatedNodes.push(e)})):e&&e.isVElement&&(this.relatedNodes=[e]);for(let e=0;e<this._relientObjects.length;e++)this._relientObjects[e].setRelientStateDirty(this)}get[s](){return!0}[n.$Symbol.iterator](){return function*(e){yield e}(this._value)}}function i(e){return new r(e)}function l(...e){let t=[],n={get value(){let t="";for(let n=0;n<e.length;n++)e[n]&&e[n][s]?t+=e[n].value:e[n]&&(t+=e[n]);return t},addRelient(e){t.push(e)},setRelientStateDirty(){t.forEach(function(e){e.setRelientStateDirty&&e.setRelientStateDirty(n)})},[s]:!0};for(let t=0;t<e.length;t++)e[t]&&e[t][s]&&e[t].addRelient(n);return n}const h=[];class o{constructor(){this.funcs={log:console.log.bind(console,"[fw2gulp LOG]"),error:console.error.bind(console,"[fw2gulp ERR]"),warn:console.warn.bind(console,"[fw2gulp WRN]")},this._enabled=!1,h.push(this)}get enabled(){return this._enabled}set enabled(e){this._enabled=e,h.forEach(t=>t._enabled=e)}log(...e){this._enabled&&this.funcs.log(...e)}error(...e){this._enabled&&this.funcs.error(...e)}warn(...e){this._enabled&&this.funcs.warn(...e)}createInternalInstance(){return this.createInstance("fw2gulp INTERNAL ")}createInstance(e){let t=new o;return t.funcs.log=console.log.bind(console,`[${e}LOG]`),t.funcs.error=console.error.bind(console,`[${e}ERR]`),t.funcs.warn=console.warn.bind(console,`[${e}WRN]`),t}}let c;var a,u=c=new o;Object.defineProperty(window||globalThis||new Function("this")(),"FW2VERBOSE",{value:c}),a||(a=requestAnimationFrame);const d=u.createInternalInstance(),f=[],p={timeout:500},m=a||requestAnimationFrame;function g(){let e=f.shift();if(e)for(e.rerender();f[0];)(e=f.shift()).rerender()}const b=n();class v{constructor(e){if(this.WARNIFINRENDER=0,this._initialized=!1,this._relient=[],this.isSvg=!1,this.props=e,!this.renderFunctionExists())throw new Error("Components must define a render function")}renderFunctionExists(){return this.render instanceof Function}renderInternal(){if(!this._initialized){let e=Object.keys(this);for(let t=0;t<e.length;t++)this[e[t]]&&this[e[t]][s]&&this[e[t]].addRelient(this);this._initialized=!0}this.WARNIFINRENDER++;let e=this.render();return this.WARNIFINRENDER--,this._element?this._element.diff(e,!0):this._element=e,this._element.element(this.isSvg)}element(){return this._element?this._element.element(this.isSvg):this.renderInternal()}render(){}rerender(){return this.WARNIFINRENDER&&console.warn("rerender initiated from within the render call, this should be avoided if posible"),this.WARNIFINRENDER>10?(console.error("rerender error: rerender is being called within render several times in a row, this most likeally means that there is an issue."),null):this.renderInternal()}addRelient(e){this._relient.includes(e)||this._relient.push(e)}setRelientStateDirty(e){f.includes(this)||f.push(this),m(g,p)}get[s](){return!0}setIsSvg(e){this.isSvg=e}}v.prototype[b]=!0;const y=!1,_=u.createInternalInstance();function O(e){let t=[];const n=Object.keys(e);for(let r=0;r<n.length;r++){const i=n[r];e[i]&&e[i][s]?t.push(e[i]):"object"==typeof e[i]&&t.push(...O(e[i]))}return t}function w(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r++){const i=n[r],l=t[i];l&&l[s]?e[i]=l.value:(Object.isSealed(e)||Object.isFrozen(e))&&(e[i]=l)}}_.enabled=!0;class j{constructor(e){this.references=new Map,this.initializer=e,this._elements=[],this._elements instanceof Array||(this._elements=[this._elements]),this.render()}render(){for(let e=0;e<this._elements.length;e++){const t=this._elements[e]._element;t.parentElement.removeChild(t)}this._elements=this.initializer();for(let e=0;e<this._elements.length;e++){const t=[...this._elements[e].references.keys()];for(let n=0;n<t.length;n++)this.references.has(t[n])||this.references.set(t[n],[]),this.references.get(t[n]).push(this._elements[e]),t[n].addRelient(this)}}setRelientStateDirty(e){return null}}function E(e,t=[]){for(let n=0;n<e.length;n++)e[n]instanceof Array?E(e[n],t):t.push(e[n]);return t}class R{constructor(e,t,n){this.childrefs=[],this.references=new Map;const s=E(n);this.type=e,this.props=t||{},this.children=s,this.states=[],this.isSvg="svg"===this.type}element(e){return this._element||this.render(e||this.isSvg),this._element}setIsSvg(e=!0){return this.isSvg||e?(this.isSvg=e,this.children.forEach(t=>{t.setIsSvg&&t.isSvg===!e?t.setIsSvg(this.isSvg):"object"==typeof t&&Object.getPrototypeOf(t)===v&&t.setIsSvg(this.isSvg)}),this.isSvg):e}render(e){e=this.setIsSvg(e||this.isSvg),this._element=e?document.createElementNS("http://www.w3.org/2000/svg",this.type):document.createElement(this.type);for(let e=0;e<this.children.length;e++){let t=R.resolve(this.children[e]);if(this.children[e]&&this.children[e][s])this.states.push(this.children[e]),this.references.has(this.children[e])||this.references.set(this.children[e],[]),this.references.get(this.children[e]).push(t),this._element.appendChild(t);else if(this.children[e]instanceof Function){this.childrefs[e]=new j(this.children[e]);let t=this.childrefs[e]._elements;for(let e=0;e<t.length;e++)this._element.appendChild(t[e]._element)}else t&&this._element.appendChild(t)}const t=Object.keys(this.props);if(this.props)for(let e=0;e<t.length;e++){const n=t[e];if(this.props[n]&&this.props[n][s])this.states.push(this.props[n]),this.references.has(this.props[n])||this.references.set(this.props[n],[]),this.references.get(this.props[n]).push(n);else if("object"==typeof this.props[n]){const e=O(this.props[n]);for(let t=0;t<e.length;t++)e[t].addRelient(this),this.states.push(e[t]),this.references.has(e[t])||this.references.set(e[t],[]),this.references.get(e[t]).push(n)}}for(let n=0;n<t.length;n++){const r=t[n];if(this.props[r]&&this.props[r][s])this._element[r]=this.props[r].value;else if("object"==typeof this.props[r])"children"!=r&&w(this._element[r],this.props[r]);else try{"on"==r.substr(0,2)?this._element.addEventListener(r.substr(2),this.props[r]):(this._element[r]=this.props[r],e&&this._element.setAttribute(r,this.props[r]))}catch(e){this._element.setAttribute(r,this.props[r])}}for(let e=0;e<this.states.length;e++)this.states[e].addRelient(this)}setRelientStateDirty(e){const t=this.references.get(e);for(let n=0;n<t.length;n++){const r=t[n];r instanceof Text?r.textContent=e.value:r instanceof HTMLSpanElement&&r.hasAttribute("is-state-wrapper")?(e.hasRelatedNodes()&&e.relatedNodes.forEach(t=>{e.relatedNodes.includes(t)||t.element().remove()}),e.value.forEach(e=>{r.appendChild(e.element())})):"string"==typeof r&&(this.props[r]&&this.props[r][s]?this.element()[r]=this.props[r].value:this.props[r]instanceof Object&&w(this.element()[r],this.props[r]))}}static resolve(e){if(e instanceof R)return e.element();if(void 0!=e&&e[s]){if(e.value&&e.value.constructor===Array){let t=document.createElement("span");t.setAttribute("is-state-wrapper","true");for(let n=0;n<e.value.length;n++)t.appendChild(R.resolve(e.value[n]));return t}return e[b]?e.renderInternal():document.createTextNode(e.value)}return null!=e&&"object"==typeof e&&Object.getPrototypeOf(e)instanceof v?e.element():null!=e?document.createTextNode(void 0!=e?e:" "):void 0}get isVElement(){return!0}diff(e){if(!S(this.props,e.props)){const t=Object.keys(this.props),n=Object.keys(e.props);for(let s=0;s<Math.max(t.length,n.length);s++){let r=t[s],i=n[s];"children"!==i&&(r&&i?this.props[r]!=e.props[r]&&(this.element()[r]=e.props[r]):r?i||delete this.element()[r]:this.element()[i]=e.props[i])}}if(this.props=e.props,e.children.length!=this.children.length){const t=this.element().parentElement;t&&(t.insertBefore(e.element(),this.element()),t.removeChild(this.element()),this._element=e.element(),this.children=e.children)}else this.children.forEach((t,n)=>{if(t&&t.diff&&"string"!=typeof e.children[n])t.diff(e.children[n]);else if(t!=e.children[n]){const t=this.element().parentElement;t&&e.element()&&this.element()!=e._element&&(t.insertBefore(e.element(),this.element()),t.removeChild(this.element()),this._element=e.element(),this.children=e.children)}})}}function S(e,t){if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;if(e.constructor!==t.constructor)return!1;for(var n in e)if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n))return!1;if(e[n]!==t[n]){if("object"!=typeof e[n])return!1;if(!S(e[n],t[n]))return!1}}for(n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}function N(e,t,...n){if("function"==typeof e){if(Object.getPrototypeOf(e)===v)return new e(Object.assign(Object.assign({},t||{}),{children:n}));return e(Object.assign(Object.assign({},t||{}),{children:n}))}return new R(e,t,n)}const I=document.createElement("style");function A(e,t){if("string"==typeof e)return e;let n="";for(let s=0;s<e.length;s++)n+=e[s]||"",n+=t[s]||"";return n}I.setAttribute("fw-style","true"),document.head?document.head.appendChild(I):document.addEventListener("load",()=>{document.head.appendChild(I)});let C=0;function D(e,...t){const n=A(e,t);I.innerHTML+=`/*${C++}*/${n}`.replace(/\n/g,"")}var F={dom:N,StatefulData:i,stateJoin:l,css:D,Component:v,verbose:u};export default F;